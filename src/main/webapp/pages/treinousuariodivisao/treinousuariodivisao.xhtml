<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	template="/WEB-INF/templates/default.xhtml">


	<ui:define name="scripts">
		<link rel="stylesheet" href="https://owlcarousel2.github.io/OwlCarousel2/assets/owlcarousel/assets/owl.carousel.min.css" />
		<link rel="stylesheet" href="https://owlcarousel2.github.io/OwlCarousel2/assets/owlcarousel/assets/owl.theme.default.min.css" />
		
		<script src="https://owlcarousel2.github.io/OwlCarousel2/assets/owlcarousel/owl.carousel.js"></script>	
	</ui:define>
	
	
    <ui:define name="corpo">
    
    	<div class="row g-2 align-items-center">
              <div class="col">
                <div class="page-pretitle">
                  Divisões do Treino
                </div>
                <h2 class="page-title">
                  #{treinoUsuarioDivisaoController.to.treinoUsuario.nome}
                </h2>
              </div>
              <!-- Page title actions -->
              <div class="col-auto ms-auto d-print-none">
                <div class="btn-list">
                  
                  <a href="#" class="btn" data-bs-toggle="modal" data-bs-target="#modal-cadastro">
                    <i class="fa fa-plus" aria-hidden="true"></i> &#160;Criar Divisão
                  </a>
                  <a href="/treinousuario" class="btn">
                    <i class="fa fa-arrow-circle-o-left" aria-hidden="true"></i> &#160;Voltar
                  </a>
                  
                </div>
              </div>
            </div>
            <div class="row">
            	<div class="col-lg-12">
            	<br />
				<div class="nonloop owl-carousel owl-loaded owl-drag">
					<div class="owl-stage-outer">
						<div class="owl-stage"
							style="transition: all; width: 2244px; transform: translate3d(-654px, 0px, 0px);">
							<ui:fragment rendered="#{!empty treinoUsuarioDivisaoController.to.calendarios}">
								<ui:repeat var="calendario" value="#{treinoUsuarioDivisaoController.to.calendarios}">
									<div class="owl-item" style="margin-right: 10px;">
										<div class="item">
											<ui:fragment rendered="#{calendario.execucoes.size() > 0}">
												<a style="text-decoration: none" href="/treinousuariodivisaoexercicio/#{calendario.execucoes.get(0).treinoUsuarioDivisaoExercicio.treinoUsuarioDivisao.uid}?data=#{calendario.dataFormatParam}">
													<div class="card" style="height: 100px">
														<div class="card-body">
															
																<div class="card-title">
																		<span style="font-size: 0.8rem">#{calendario.dataFormat}</span> <small style="font-size: 0.7rem">#{calendario.diaSemanaFormat}</small>
																		<span class="badge" style="border-color: #{calendario.execucoes.get(0).treinoUsuarioDivisaoExercicio.treinoUsuarioDivisao.cor};background:#{calendario.execucoes.get(0).treinoUsuarioDivisaoExercicio.treinoUsuarioDivisao.cor}">
																			#{calendario.execucoes.get(0).treinoUsuarioDivisaoExercicio.treinoUsuarioDivisao.nome}
																		</span>
																	<br />
																	<span class="gl-star-rating gl-star-rating--ltr" data-star-rating="" style="font-size: 0.8rem">
																		<span class="gl-star-rating--stars" data-rating="5">
																			<ui:fragment rendered="#{((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) gt 0}">	
																				<span data-index="0" data-value="1" class="gl-active" style="color:#f59f00"><i class="fa fa-star" aria-hidden="true"></i></span>
																				<ui:fragment rendered="#{((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) ge 25}">
																					<span data-index="1" data-value="2" class="gl-active" style="color:#f59f00"><i class="fa fa-star" aria-hidden="true"></i></span>
																					<ui:fragment rendered="#{((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) ge 50}">
																						<span data-index="2" data-value="3" class="gl-active" style="color:#f59f00"><i class="fa fa-star" aria-hidden="true"></i></span>
																							<ui:fragment rendered="#{((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) ge 75}">
																								<ui:fragment rendered="#{((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) eq 100}">
																									<span data-index="4" data-value="5" class="gl-selected gl-active" style="color:#f59f00"><i class="fa fa-star" aria-hidden="true"></i></span>
																								</ui:fragment>	
																								<ui:fragment rendered="#{!(((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) eq 100)}">
																									<span data-index="4" data-value="5" class="gl-selected gl-active" style="color:#f59f00"><i class="fa fa-star-half-o" aria-hidden="true"></i></span>
																								</ui:fragment>			
																							</ui:fragment>
																							<ui:fragment rendered="#{!(((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) ge 75)}">
																								<span data-index="3" data-value="4" class="gl-active" style="color:#f59f00"><i class="fa fa-star-o" aria-hidden="true"></i></span>
																							</ui:fragment>		
																					</ui:fragment>
																					<ui:fragment rendered="#{!(((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) ge 50)}">
																						<span data-index="2" data-value="3" class="gl-active" style="color:#f59f00"><i class="fa fa-star-o" aria-hidden="true"></i></span>
																						<span data-index="3" data-value="4" class="gl-active" style="color:#f59f00"><i class="fa fa-star-o" aria-hidden="true"></i></span>
																					</ui:fragment>	
																				</ui:fragment>
																				<ui:fragment rendered="#{!(((calendario.execucoes.size() * 100) / calendario.execucoes.get(0).qtdExercicios) ge 25)}">
																					<span data-index="1" data-value="2" class="gl-active" style="color:#f59f00"><i class="fa fa-star-o" aria-hidden="true"></i></span>
																					<span data-index="2" data-value="3" class="gl-active" style="color:#f59f00"><i class="fa fa-star-o" aria-hidden="true"></i></span>
																					<span data-index="3" data-value="4" class="gl-active" style="color:#f59f00"><i class="fa fa-star-o" aria-hidden="true"></i></span>
																				</ui:fragment>
																			</ui:fragment>
																		</span>
																	</span>	
																</div>	
														
														</div>
													</div>
												</a>
											</ui:fragment>	
											<ui:fragment rendered="#{calendario.execucoes.size() eq 0}">
												<div class="card" style="height: 100px">
														<div class="card-body">
																<div class="card-title">
																	<span style="font-size: 0.7rem">
																		#{calendario.dataFormat} </span><small style="font-size: 0.7rem">#{calendario.diaSemanaFormat}</small>
																	<br />
																</div>
																<div class="text-center">
																	<h:commandLink styleClass="text-center">
																		<i class="fa fa-plus-square-o" aria-hidden="true" style="font-size: 1rem"></i>
																		<f:setPropertyActionListener target="#{treinoUsuarioDivisaoController.to.paramData}" value="#{calendario.dataFormatParam}" />
																		<f:ajax render="modal-add-panel" />
																		<f:passThroughAttribute name="data-bs-toggle" value="modal" />
																		<f:passThroughAttribute name="data-bs-target" value="#modal-add" />
																	</h:commandLink>	
																	
																</div>
														</div>				
													</div>
											</ui:fragment>	
										</div>
											
										</div>
								</ui:repeat>
							</ui:fragment>		
						</div>
					</div>
				</div>
			</div>
            </div>
            
    	<ui:fragment rendered="#{customIdentity.usuario.perfil.name eq 'ALUNO'}">
    		
    		<ui:fragment rendered="#{!empty treinoUsuarioDivisaoController.to.treinoUsuarioDivisoes}">
	    		<ui:repeat var="treinoUsuarioDivisao" value="#{treinoUsuarioDivisaoController.to.treinoUsuarioDivisoes}">
	    			<div class="row">
	    				<div class="col-10 col-lg-11" style="margin-top:10px;padding-left:0px;padding-right:2px">
				    			<a href="/treinousuariodivisaoexercicio/#{treinoUsuarioDivisao.uid}">
					    			<div class="card">
					                  <div class="card-header">
					                    	<h3 class="card-title">#{treinoUsuarioDivisao.nome}</h3>
					                  </div>
					                  <div class="card-status-start" style="background-color: #{treinoUsuarioDivisao.cor}"></div>
					                </div>
					            </a>    
				                
			              </div>
			              
			              <div class="col-2 col-lg-1" style="margin-top:10px;padding-left:0px;">
			                	<span class="dropdown">
	                              <button class="btn dropdown-toggle align-text-top" style="height: 58px" data-bs-boundary="viewport" data-bs-toggle="dropdown" aria-expanded="false">
	                              	<i class="fa fa-gears"></i>
	                              </button>
	                              <div class="dropdown-menu dropdown-menu-end" style="">
									<h:commandLink styleClass="dropdown-item">
										<i class="fa fa-edit" style="font-size: 21px;"></i>&#160; Editar
										<f:setPropertyActionListener target="#{treinoUsuarioDivisaoController.to.treinoUsuarioDivisao}" value="#{treinoUsuarioDivisao}" />
										<f:ajax render="modal-cadastrar-panel" />
										<f:passThroughAttribute name="data-bs-toggle" value="modal" />
										<f:passThroughAttribute name="data-bs-target" value="#modal-cadastro" />
									</h:commandLink>
	                                <h:commandLink styleClass="dropdown-item">
										<i class="fa fa-trash" style="font-size: 21px;"></i>&#160; Excluir
										<f:setPropertyActionListener target="#{treinoUsuarioDivisaoController.to.treinoUsuarioDivisaoAcao}" value="#{treinoUsuarioDivisao}" />
										<f:ajax render="modal-excluir-panel" />
										<f:passThroughAttribute name="data-bs-toggle" value="modal" />
										<f:passThroughAttribute name="data-bs-target" value="#modal-excluir" />
									</h:commandLink>
	                              </div>
	                            </span>
			                </div>
		              </div>  
	    		</ui:repeat>
    		</ui:fragment>
    		<ui:fragment rendered="#{empty treinoUsuarioDivisaoController.to.treinoUsuarioDivisoes}">
    			<div class="page page-center">
			      <div class="container-tight py-4">
			        <div class="empty">
			          <p class="empty-title">Nenhuma divisão encontrada!</p>
			          <p class="empty-subtitle text-secondary">
			            Inclua as divisões do treino.
			          </p>
			        </div>
			      </div>
			    </div>	
    		</ui:fragment>
    		
    		
    	</ui:fragment>
    	
    	<div class="modal modal-blur fade" id="modal-cadastro" tabindex="-1" style="display: none;" aria-hidden="true">
	      <div class="modal-dialog modal-dialog-centered" role="document">
	        <div class="modal-content">
	          <h:panelGroup id="modal-cadastrar-panel">	
		          <div class="modal-header">
		            <h5 class="modal-title">Adicionar Divisão</h5>
		            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		          </div>
		          <div class="modal-body">
		            <div class="row mb-3 align-items-end">
		              <div class="col">
		                <label class="form-label">Nome</label>
		                <h:inputText value="#{treinoUsuarioDivisaoController.to.treinoUsuarioDivisao.nome}" styleClass="form-control"></h:inputText>
		                
		              </div>
		              <div class="col">
		                <label class="form-label">Cor</label>
		                <h:inputText value="#{treinoUsuarioDivisaoController.to.treinoUsuarioDivisao.cor}" styleClass="form-control">
		                	<f:passThroughAttribute name="type" value="color"/>
		                </h:inputText>
		                
		              </div>
		            </div>
		          </div>
		      </h:panelGroup>    
	          <div class="modal-footer">
	            <button type="button" class="btn me-auto" data-bs-dismiss="modal">Close</button>
	            <h:commandLink action="#{treinoUsuarioDivisaoController.gravar()}" styleClass="btn btn-primary">Gravar</h:commandLink>
	          </div>
	        </div>
	      </div>
    	</div>
    	
    	<div class="modal modal-blur fade" id="modal-excluir" tabindex="-1" style="display: none;" aria-hidden="true">
		      <div class="modal-dialog modal-sm modal-dialog-centered" role="document">
		        <div class="modal-content">
		          <h:panelGroup id="modal-excluir-panel"> 	
			          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			          <div class="modal-status bg-danger"></div>
			          <div class="modal-body text-center py-4">
			            <h3>Confirmação</h3>
			            <div class="text-secondary">Deseja remover a divisão #{treinoUsuarioDivisaoController.to.treinoUsuarioDivisaoAcao.nome} ?</div>
			          </div>
			          <div class="modal-footer">
			            <div class="w-100">
			              <div class="row">
			                <div class="col"><a href="#" class="btn w-100" data-bs-dismiss="modal">
			                    Cancel
			                  </a></div>
			                <div class="col">
			                  <h:commandLink action="#{treinoUsuarioDivisaoController.excluir()}" styleClass="btn btn-danger w-100">
			                    Sim
			                  </h:commandLink>
			                  </div>
			              </div>
			            </div>
			          </div>
				   </h:panelGroup>   
		        </div>
		      </div>
		 </div>
		 
		 <div class="modal modal-blur fade" id="modal-add" tabindex="-1" style="display: none;" aria-hidden="true">
	      <div class="modal-dialog modal-dialog-centered" role="document">
	        <div class="modal-content">
	          <h:panelGroup id="modal-add-panel">	
		          <div class="modal-header">
		            <h5 class="modal-title">Escolha uma divisão:</h5>
		            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
		          </div>
		          <div class="modal-body">
		            <ui:repeat var="treinoUsuarioDivisao" value="#{treinoUsuarioDivisaoController.to.treinoUsuarioDivisoes}">
		    			<div class="row">
		    				<div class="col-10 col-lg-11" style="margin-top:10px;padding-left:0px;padding-right:2px">
					    			<a href="/treinousuariodivisaoexercicio/#{treinoUsuarioDivisao.uid}?data=#{treinoUsuarioDivisaoController.to.paramData}">
						    			<div class="card">
						                  <div class="card-header">
						                    	<h3 class="card-title">#{treinoUsuarioDivisao.nome}</h3>
						                  </div>
						                  <div class="card-status-start" style="background-color: #{treinoUsuarioDivisao.cor}"></div>
						                </div>
						            </a>    
				              </div>
				          </div>
				     </ui:repeat>         
		          </div>
		      </h:panelGroup>    
	          <div class="modal-footer">
	            <button type="button" class="btn me-auto" data-bs-dismiss="modal">Close</button>
	          </div>
	        </div>
	      </div>
    	</div>
		 
		 <script>
		 var totalItems = $('.owl-carousel .owl-item').length;
		 console.log('Total itens', totalItems);
		 var owl = $('.owl-carousel').owlCarousel({
		        loop:false,
		        margin:10,
		        autoplayHoverPause:false,
		        responsive:{
	                0:{
	                    items:3
	                },
	                600:{
	                    items:6
	                },
	                800:{
	                    items:8
	                },
	                1300:{
	                    items:10
	                }
	            }
		    });
		 var totalItems = owl.find('.owl-stage').children().length;
		 var lastIndex = totalItems - 1;
		 owl.trigger('to.owl.carousel', [lastIndex, 50, true]);
		 </script>
    </ui:define>
</ui:composition>    